Lab: High-level logic vulnerability


Buying item: Lightweight l33t leather jacket
Credentials: wiener:peter

Store credits: $100.00
Item's i'm going buy: $1337.00

------------------------------------------------------

Behaviour:
- When i thought of the old lab trick --> manipulating the price.
But price parameter doesn't handled in the client side.

- The available paramater: productId=1&redir=PRODUCT&quantity=1

---------------------------------------------------------

Exploitation:

1. Captured the request with quantity 
2. So tried to manipulate the quantity of "Snow Delivered To Your Door" item from 1 to -57 --> reflected.

PRICE: $23.19 x (-57) = -$1,321.83

3. Now i ordered a leather jacket (which is our target) which bypass the negative price.

Leather Jacket's PRICE: $1337.00

AFTER MANIPULATION: -$1,321.83 + $1337.00 = $15.17

BOOM !!

---------------------------------------------------------

Mistake i made before:
1. I added leather jacket as negative quantity
2. I added other items as positive quantity
--> I done in terms to tally the price. Not knowingly kept the target as negative quantity.
--> Negative quantity only works to reduce the cost only, not the target order will be placed.

----------------------------------------------------------

Exploited: Quantity in request which is chained with price (negative quantity handling).

----------------------------------------------------------